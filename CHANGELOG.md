# Changelog

所有重要更改都会记录在此文件中。

## [1.18.0] - 2025-01-06

### 修复
- 🐛 **修复多行Cookie格式问题** - 从浏览器复制的多行Cookie会自动合并为单行
- 🐛 **修复URL不可见字符问题** - 自动清理URL中的BOM、零宽字符等不可见字符
- 🐛 **修复Cookie验证逻辑** - 随便填Cookie不再能通过验证，必须有真实的登录状态才会返回有效
- 🐛 **修复PT站点辅助器Cookie解析** - 支持多行格式的Cookie字符串

### 改进
- ✨ RSS默认最大种子年龄从10分钟改为60分钟（更宽松）
- ✨ RSS每次最大添加种子数从5个改为10个
- ✨ 添加RSS抓取失败时的详细错误日志
- ✨ 更新前端RSS设置说明，解释首次运行模式

### 说明
- **关于RSS和Cookie**: 大多数PT站的RSS链接已包含passkey，不需要填写Cookie。Cookie主要用于下载.torrent文件时的认证。
- **首次运行模式**: 新添加站点的首次RSS抓取只会记录种子hash，不会添加种子（防止一次性添加大量旧种）。第二次抓取起开始正常添加。清除缓存可重置此状态。

## [1.16.0] - 2025-01-05

### 修复
- 🐛 修复 Cookie 检测 401 未授权错误（fetch 请求添加 `credentials: 'include'`）
- 🐛 修复移动端设置页面按钮溢出屏幕（添加 `flex-wrap: wrap`）
- 🐛 修复添加站点按钮 loading 状态变形
- 🐛 修复限速状态显示错误（使用 `is_running()` 方法）
- 🐛 修复 RSS 解析 BOM 字符导致的错误
- 🐛 修复 `PTSiteHelperManager` 线程死锁问题（`Lock` 改为 `RLock`）

### 改进
- ✨ 增强 Flask session 配置（SameSite, permanent）
- ✨ 改进 feedparser 错误处理
- ✨ HTTP 请求增加双重超时（连接超时 + 读取超时）
- ✨ 添加更详细的调试日志

## [1.15.0] - 2025-01-05

### 修复
- 🐛 修复移动端设置页面显示不全
- 🐛 修复 Cookie 检测超时无响应
- 🐛 修复添加站点按钮样式问题

### 改进
- ✨ 增强所有 API 错误处理
- ✨ 按钮 loading 状态使用纯 CSS 方案

## [1.14.0] - 2025-01-04

### 新增
- ✨ 配置导入/导出功能
- ✨ U2 辅助器增强

### 修复
- 🐛 修复按钮样式问题

## [1.13.0] - 2025-01-03

### 改进
- ✨ 种子周期历史图表
- ✨ 仪表盘增强

## [1.12.0] - 2025-01-02

### 新增
- ✨ Vertex 风格 RSS（只抓取真正新发布的种子）

## [1.11.0] - 2025-01-01

### 新增
- ✨ UI 优化
- ✨ Loading 遮罩
- ✨ 种子状态持久化
- ✨ TG 通知修复

## [1.10.0] - 2024-12-31

### 修复
- 🐛 修复 RSS 问题
- 🐛 修复移动端适配
- 🐛 修复限速状态
- 🐛 修复内置规则
- 🐛 修复前后端参数不匹配

## [1.5.0] - 2024-12-28

### 新增
- ✨ 下载限速功能
- ✨ 通用站点辅助器（支持所有 NexusPHP 站点）

## [1.4.0] - 2024-12-27

### 新增
- ✨ U2 辅助器

## [1.3.0] - 2024-12-26

### 新增
- ✨ RSS 自动抓取

## [1.0.0] - 2024-12-20

### 新增
- 🎉 初始版本
- ✨ 多 qB 实例管理
- ✨ 智能限速（PID/Kalman 控制器）
- ✨ 自动删种（8 个内置规则）
- ✨ Telegram 通知
- ✨ 认证系统
